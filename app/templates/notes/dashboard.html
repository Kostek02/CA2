{# Notes Dashboard Template - v0.9.1: Functional baseline #}
{# Displays list of all notes with CRUD action links #}
{% extends "base.html" %}
{% block content %}
<main>
    <h1>Notes Dashboard</h1>
    
    {# Create new note button #}
    <div style="margin-bottom: 1.5rem;">
        <a href="{{ url_for('notes.create_note') }}" class="btn btn-primary">
            Create New Note
        </a>
    </div>

    {# Notes list - displays all notes or empty state #}
    {% if notes %}
        <div class="notes-list">
            {% for note in notes %}
                <div class="note-card" style="border: 1px solid #ddd; padding: 1rem; margin-bottom: 1rem; border-radius: 4px;">
                    {# Note title (clickable link to view) #}
                    <h3>
                        <a href="{{ url_for('notes.view_note', note_id=note['id']) }}">
                            {{ note['title'] }}
                        </a>
                    </h3>
                    {# Note content preview (first 100 chars) #}
                    <p style="color: #666; font-size: 0.9em;">
                        {{ note['content'][:100] }}{% if note['content']|length > 100 %}...{% endif %}
                    </p>
                    {# Creation timestamp #}
                    <div style="margin-top: 0.5rem; font-size: 0.85em; color: #999;">
                        Created: {{ note['created_at'] }}
                    </div>
                    {# CRUD action links #}
                    <div style="margin-top: 0.5rem;">
                        <a href="{{ url_for('notes.view_note', note_id=note['id']) }}">
                            View</a> |
                        {% if note['user_id'] == current_user.id or current_user.is_admin() %}
                            <a href="{{ url_for('notes.edit_note', note_id=note['id']) }}">Edit</a> |
                        {% endif %}
                        
                        {# Delete button: For note owners, moderators (any note), or admins #}
                        {% if note['user_id'] == current_user.id or current_user.is_moderator() or current_user.is_admin() %}
                            <a href="{{ url_for('notes.delete_note', note_id=note['id']) }}">Delete</a>
                        {% endif %}
                        
                        {# Optional: Show role indicator in navigation or dashboard #}
                        {% if current_user.is_authenticated %}
                            <span style="font-size: 0.875rem; color: #6c757d;">
                                {% if current_user.is_admin() %}
                                    [Admin]
                                {% elif current_user.is_moderator() %}
                                    [Moderator]
                                {% else %}
                                    [User]
                                {% endif %}
                            </span>
                        {% endif %}
                        
                        {# Optional: Show note owner in dashboard (for moderators/admins viewing all notes) #}
                        {% if current_user.is_moderator() or current_user.is_admin() %}
                            <small style="color: #6c757d;">Owner ID: {{ note['user_id'] }}</small>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        {# Empty state when no notes exist #}
        <p>No notes yet. <a href="{{ url_for('notes.create_note') }}">Create your first note!</a></p>
    {% endif %}
</main>
{% endblock %}